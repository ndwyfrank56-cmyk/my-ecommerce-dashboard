<!-- Modern Flash Messages - Include this in all pages -->
<style>
  .flash-toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 350px;
  }
  
  .flash-toast {
    background: #e8e9ea;
    border-radius: 10px;
    padding: 14px 18px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 12px;
    border-left: 3px solid var(--accent-color);
    animation: slideIn 0.3s ease-out;
    min-width: 280px;
  }
  
  @keyframes slideIn {
    from {
      transform: translateX(400px);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(400px);
      opacity: 0;
    }
  }
  
  .flash-toast.closing {
    animation: slideOut 0.3s ease-in forwards;
  }
  
  .flash-toast-success {
    --accent-color: #10b981;
  }
  
  .flash-toast-error {
    --accent-color: #ef4444;
  }
  
  .flash-toast-warning {
    --accent-color: #f59e0b;
  }
  
  .flash-toast-info {
    --accent-color: #3b82f6;
  }
  
  .flash-toast-icon {
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    color: var(--accent-color);
    font-weight: 700;
  }
  
  .flash-toast-content {
    flex: 1;
    color: #2d3748;
    font-size: 14px;
    line-height: 1.5;
    font-weight: 500;
  }
  
  .flash-toast-close {
    flex-shrink: 0;
    background: transparent;
    border: none;
    color: #6b7280;
    cursor: pointer;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    font-size: 18px;
    line-height: 1;
  }
  
  @media (max-width: 640px) {
    .flash-toast-container {
      top: 15px;
      right: 15px;
      left: 15px;
      max-width: none;
      gap: 12px;
    }
    
    .flash-toast {
      min-width: auto;
      padding: 12px 14px;
    }
    
    .flash-toast-content {
      font-size: 13px;
    }
  }
</style>

<div class="flash-toast-container" id="flashToastContainer">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash-toast flash-toast-{{ category }}" data-flash-id="{{ loop.index }}">
          <div class="flash-toast-icon">
            {% if category == 'success' %}
              ✓
            {% elif category == 'error' %}
              ✕
            {% elif category == 'warning' %}
              ⚠
            {% else %}
              ℹ
            {% endif %}
          </div>
          <div class="flash-toast-content">{{ message }}</div>
          <button class="flash-toast-close" onclick="closeFlashToast(this)" aria-label="Close">×</button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>

<script>
  function closeFlashToast(button) {
    const toast = button.closest('.flash-toast');
    toast.classList.add('closing');
    setTimeout(() => {
      toast.remove();
    }, 300);
  }
  
  // Auto-close flash messages after 5 seconds
  document.addEventListener('DOMContentLoaded', function() {
    const toasts = document.querySelectorAll('.flash-toast');
    toasts.forEach((toast, index) => {
      setTimeout(() => {
        if (toast.parentElement) {
          toast.classList.add('closing');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }
      }, 5000 + (index * 500)); // Stagger auto-close
    });
  });
</script>
